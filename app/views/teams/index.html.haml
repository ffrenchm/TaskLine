= provide(:title, "Teams")
= provide(:button_text, "Create")
.split-layout
  .main
    .box.break
      %h2 Your Teams
      - if @teams.any?
        - @teams.each do |team|
          .sub-box
            .title-wrapper
              %h2= link_to team.name, team
            .big-links
              - if Membership.find_by(user_id: @user.id, team_id: team.id).admin == true
                %span
                  = link_to "", team, class: "fa fa-trash", method: :delete, remote: true, data: { confirm: "Are you sure? All other members will lose access to this team" }
                %span
                  = link_to "", edit_team_path(team), class: "fa fa-pencil-square-o"
            .sub-info
              = pluralize(team.users.count, "Member")
            %br/
            - team.users[0..11].each do |user|
              = image_tag user.picture.url, size: "39x39", class: "small-pic"
      - else
        %p You're not a member of any teams. Join a public team, or create one yourself using the form on the right.
    .box
      %h2 Public Teams
      - Team.where(public: 1).each do |team|
        - unless team.users.include?(current_user)
          .sub-box
            .title-wrapper
              %h2= link_to team.name, team
            .small-links
              %span
                = link_to "Join", team_memberships_path(team), method: :post, remote: true
            .sub-info
              = pluralize team.users.count, "Member"
            %br/
            - team.users[0..11].each do |user|
              = image_tag user.picture.url, size: "39x39", class: "small-pic"
  .aside
    .box
      = render 'teams/team_form'
    = render 'shared/invites'
